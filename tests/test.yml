---
- hosts: all
  become: yes

  # if the distro doesn't ship with python
  # this shims it in before fact gathering
  gather_facts: false
  pre_tasks:
  - name: Install python2 for Ansible
    raw: sh -c "test -e /usr/bin/python || ( ( test -e /usr/bin/apt && apt -qqy update && apt install -qqy python-minimal) || ( test -e /usr/bin/dnf && /usr/bin/dnf -qy install python) || ( test -e /usr/bin/yum && /usr/bin/yum -qy install python) )"
    register: output
    changed_when: 'output.stdout|trim() != ""'
  - name: Gathering Facts
    setup:
    tags: always
  # end of python shim

  tasks:

    # - name: include any roles that are specified in the test-kitchen suite
    #   include_role:
    #     name: "{{ tk_dep_roles_item }}"
    #   loop_control:
    #     loop_var: tk_dep_roles_item
    #   with_items: "{{ tk_dep_roles }}"

    # - set_fact:
    #     write_hosts_file: yes
    #   tags: always

    - name: import the role limepepper.wordpress in test.yml playbook
      import_role:
        name: '{{playbook_dir}}/..'
